batch_size =128


model = run_exp(experiment_name = 'xombined_model_simpler_demographics',
            train_loader = train_loader,
            val_loader = val_loader,
            depth=4,
            heads=2,
            dynamic_dim_in=18,
            dynamic_dim_out=128,
            max_seq_len=924,
            attn_dropout=0,
            ff_dropout=0,
            batch_norm=False,
            scalar_input_dim=40,
            scalar_mlp_hidden_dim=128,
            embedding_hidden_dim=128,
            ensemble_mlp_hidden_dim=512,
            output_dim=1,
            l1_lambda=0,
            l2_lambda=0,
            lr=1e-5,
            pos_weight_value=20.0,
            epochs = 15,
            max_norm=10,
            patience=10,
            lr_patience=5,
            device="cpu",
            target_outcome = 'cardiac')